package main;

import java.util.Random;

public class GameSetup {
	
	private int bombs = 10;
	private int gridSize= 10;
	private int[][] hidden = new int[this.gridSize][this.gridSize];
	private int[][] visible = new int[this.gridSize][this.gridSize];
	private boolean gameOver;
	
	public boolean isGameOver() {
		return gameOver;
	}
	public void setGameOver(boolean gameOver) {
		this.gameOver = gameOver;
	}
	
	public void setupHidden() {
		setupBombs();
		for(int i = 0; i < this.gridSize; i++) {
			for(int j = 0; j< this.gridSize; j++) {
				if(this.hidden[i][j]!=-1) {
					countAdjBombs(j,i);
				}
			}
		}
		
	}
	private void setupBombs() {
		
		Random random = new Random();
		System.out.println("Setting up bombs");
		for(int i = 0; i < this.bombs; i++) {
			
			int row = random.nextInt(this.gridSize);
			int col = random.nextInt(this.gridSize);
			System.out.println(row + " " + col);
			this.hidden[row][col] = -1;
		}
		
	}
	
	private int countAdjBombs(int row, int col) {
		int tempRow = 0;
		int tempCol = 0;
		int bombsCounted = 0;
		for(int i = -1; i <=1; i++) {
			for(int j = -1; j<=1; j++) {
				if(row == 0 || col == 0) {
					continue;
				}
				if(row==9 || col==9) {
					continue;
				}
				
				tempRow = row+i; 
				tempCol = col+j;
				
				if(this.hidden[tempRow][tempCol]==-1) {
					bombsCounted++;
				}
			}
		}
		return bombsCounted;
	}
	public void displayVisible() {
		System.out.print("\t ");
		for(int i =0; i < gridSize; i ++) {
			System.out.print(String.format("| %d ", i+1));
		}
		System.out.print("| \n");
		for(int i=0; i < gridSize; i++) {
			System.out.print(String.format("%d \t | ", i+1));
			for(int j=0; j<gridSize; j++) {
				if(this.visible[i][j]!=-1) {
					System.out.print(this.visible[i][j]);
				}
				else {
					System.out.println("You hit a bomb!");
				}
				System.out.print(" | ");
			}
			System.out.println();
		}
	}
	public void setVisibleFromGuess(int row, int col) {
		System.out.println("Hidden " + this.hidden[row][col]);
		this.visible[row][col] = this.hidden[row][col];
		System.out.println("Visible " + this.visible[row][col]);
		if(this.visible[row][col]==-1) {
			setGameOver(true);
		}
		
	}
	public void displayHidden() {
		System.out.print("\t ");
		for(int i =0; i < gridSize; i ++) {
			System.out.print(String.format("| %d ", i+1));
		}
		System.out.print("| \n");
		for(int i=0; i < gridSize; i++) {
			System.out.print(String.format("%d \t | ", i+1));
			for(int j=0; j<gridSize; j++) {
				if(this.hidden[i][j]!=-1) {
					System.out.print(this.hidden[i][j]);
				}
				else {
					System.out.print("â– ");
				}
				System.out.print(" | ");
			}
			System.out.println();
		}
	}
}
